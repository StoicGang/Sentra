============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Ganes\Desktop\Sentra\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\Ganes\Desktop\Sentra
plugins: cov-7.0.0
collecting ... collected 85 items

tests/test_recovery_manager.py::TestCodeHelpers::test_generate_code_format PASSED [  1%]
tests/test_recovery_manager.py::TestCodeHelpers::test_generate_code_random PASSED [  2%]
tests/test_recovery_manager.py::TestCodeHelpers::test_normalise_strips_whitespace PASSED [  3%]
tests/test_recovery_manager.py::TestSetupPassphrase::test_happy_path PASSED [  4%]
tests/test_recovery_manager.py::TestSetupPassphrase::test_empty_passphrase_raises PASSED [  5%]
tests/test_recovery_manager.py::TestSetupPassphrase::test_whitespace_only_passphrase_raises PASSED [  7%]
tests/test_recovery_manager.py::TestSetupPassphrase::test_wrong_vault_key_size_raises PASSED [  8%]
tests/test_recovery_manager.py::TestSetupPassphrase::test_replaces_existing_passphrase PASSED [  9%]
tests/test_recovery_manager.py::TestSetupCodes::test_returns_correct_count PASSED [ 10%]
tests/test_recovery_manager.py::TestSetupCodes::test_codes_unique PASSED [ 11%]
tests/test_recovery_manager.py::TestSetupCodes::test_code_format PASSED  [ 12%]
tests/test_recovery_manager.py::TestSetupCodes::test_replaces_existing_codes PASSED [ 14%]
tests/test_recovery_manager.py::TestSetupCodes::test_invalid_count_raises PASSED [ 15%]
tests/test_recovery_manager.py::TestSetupCodes::test_wrong_vault_key_size_raises PASSED [ 16%]
tests/test_recovery_manager.py::TestRecoverWithPassphrase::test_correct_passphrase_returns_vault_key PASSED [ 17%]
tests/test_recovery_manager.py::TestRecoverWithPassphrase::test_wrong_passphrase_raises PASSED [ 18%]
tests/test_recovery_manager.py::TestRecoverWithPassphrase::test_no_passphrase_configured_raises PASSED [ 20%]
tests/test_recovery_manager.py::TestRecoverWithPassphrase::test_passphrase_is_case_sensitive PASSED [ 21%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_correct_code_returns_vault_key PASSED [ 22%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_wrong_code_raises PASSED [ 23%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_no_codes_configured_raises PASSED [ 24%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_code_is_case_insensitive PASSED [ 25%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_code_whitespace_stripped PASSED [ 27%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_used_code_rejected_on_second_attempt PASSED [ 28%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_used_code_does_not_invalidate_other_codes PASSED [ 29%]
tests/test_recovery_manager.py::TestRecoverWithCode::test_code_marked_used_in_db PASSED [ 30%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_status_disabled_when_empty PASSED [ 31%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_status_passphrase_only PASSED [ 32%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_status_codes_only PASSED [ 34%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_status_codes_decremented_after_use PASSED [ 35%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_status_both PASSED [ 36%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_disable_clears_all PASSED [ 37%]
tests/test_recovery_manager.py::TestDisableAndStatus::test_disable_idempotent PASSED [ 38%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_setup_recovery_passphrase_requires_unlock PASSED [ 40%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_setup_recovery_codes_requires_unlock PASSED [ 41%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_setup_passphrase_roundtrip_via_controller PASSED [ 42%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_setup_codes_returns_list_via_controller PASSED [ 43%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_recover_vault_with_passphrase PASSED [ 44%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_recover_vault_with_code PASSED [ 45%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_recover_wrong_passphrase_raises PASSED [ 47%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_disable_recovery_via_controller PASSED [ 48%]
tests/test_recovery_manager.py::TestVaultControllerRecovery::test_get_recovery_status_no_unlock_required PASSED [ 49%]
tests/test_adaptive_lockout.py::TestInit::test_defaults_are_sane PASSED  [ 50%]
tests/test_adaptive_lockout.py::TestInit::test_custom_config_accepted PASSED [ 51%]
tests/test_adaptive_lockout.py::TestInit::test_non_int_config_raises PASSED [ 52%]
tests/test_adaptive_lockout.py::TestInit::test_zero_history_window_raises PASSED [ 54%]
tests/test_adaptive_lockout.py::TestInit::test_zero_hard_lockout_threshold_raises PASSED [ 55%]
tests/test_adaptive_lockout.py::TestNoFailures::test_no_history_is_immediately_allowed PASSED [ 56%]
tests/test_adaptive_lockout.py::TestSoftBackoff::test_one_failure_blocks_for_one_second PASSED [ 57%]
tests/test_adaptive_lockout.py::TestSoftBackoff::test_two_failures_blocks_for_two_seconds PASSED [ 58%]
tests/test_adaptive_lockout.py::TestSoftBackoff::test_three_failures_blocks_for_four_seconds PASSED [ 60%]
tests/test_adaptive_lockout.py::TestSoftBackoff::test_delay_caps_at_max_delay PASSED [ 61%]
tests/test_adaptive_lockout.py::TestSoftBackoff::test_expired_backoff_allows_attempt PASSED [ 62%]
tests/test_adaptive_lockout.py::TestHardLockout::test_at_threshold_triggers_hard_lockout PASSED [ 63%]
tests/test_adaptive_lockout.py::TestHardLockout::test_above_threshold_still_hard_locked PASSED [ 64%]
tests/test_adaptive_lockout.py::TestHardLockout::test_hard_lockout_expires_allows_attempt PASSED [ 65%]
tests/test_adaptive_lockout.py::TestHardLockout::test_custom_threshold PASSED [ 67%]
tests/test_adaptive_lockout.py::TestSideEffects::test_record_failure_delegates_to_db PASSED [ 68%]
tests/test_adaptive_lockout.py::TestSideEffects::test_reset_session_clears_history PASSED [ 69%]
tests/test_adaptive_lockout.py::TestGetStatus::test_clean_state PASSED   [ 70%]
tests/test_adaptive_lockout.py::TestGetStatus::test_soft_backoff_state PASSED [ 71%]
tests/test_adaptive_lockout.py::TestGetStatus::test_hard_lockout_state PASSED [ 72%]
tests/test_adaptive_lockout.py::TestGetStatus::test_get_status_message_alias PASSED [ 74%]
tests/test_adaptive_lockout.py::TestVaultControllerIntegration::test_unlock_raises_account_locked_error_when_locked PASSED [ 75%]
tests/test_adaptive_lockout.py::TestVaultControllerIntegration::test_account_locked_error_has_next_allowed_at PASSED [ 76%]
tests/test_backup_manager.py::test_init_rejects_non_dict_hierarchy PASSED [ 77%]
tests/test_backup_manager.py::test_init_rejects_missing_vault_key PASSED [ 78%]
tests/test_backup_manager.py::test_init_rejects_bad_vault_key_length PASSED [ 80%]
tests/test_backup_manager.py::test_init_rejects_equal_enc_and_hmac_keys PASSED [ 81%]
tests/test_backup_manager.py::test_create_backup_success_all_entries PASSED [ 82%]
tests/test_backup_manager.py::test_create_backup_with_selection PASSED   [ 83%]
tests/test_backup_manager.py::test_create_backup_rejects_bad_vault_keys_tuple PASSED [ 84%]
tests/test_backup_manager.py::test_create_backup_requires_internal_vault_key PASSED [ 85%]
tests/test_backup_manager.py::test_create_backup_wraps_internal_errors PASSED [ 87%]
tests/test_backup_manager.py::test_create_backup_v2_produces_encrypted_file PASSED [ 88%]
tests/test_backup_manager.py::test_create_and_restore_v2_round_trip PASSED [ 89%]
tests/test_backup_manager.py::test_restore_rejects_too_short_file PASSED [ 90%]
tests/test_backup_manager.py::test_restore_rejects_invalid_header_len PASSED [ 91%]
tests/test_backup_manager.py::test_restore_rejects_hmac_mismatch PASSED  [ 92%]
tests/test_backup_manager.py::test_restore_rejects_unsupported_version PASSED [ 94%]
tests/test_backup_manager.py::test_restore_rejects_entry_count_mismatch PASSED [ 95%]
tests/test_backup_manager.py::test_restore_v1_still_works PASSED         [ 96%]
tests/test_backup_manager.py::test_restore_backup_v2_success PASSED      [ 97%]
tests/test_backup_manager.py::test_restore_phase1_error_raises_without_db_transaction PASSED [ 98%]
tests/test_backup_manager.py::test_restore_phase2_db_failure_triggers_rollback PASSED [100%]

============================= 85 passed in 7.39s ==============================
